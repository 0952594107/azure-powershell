<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="RunTest" ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <LibraryRoot>..\..\..\</LibraryRoot>
    <LibraryToolsFolder>$(LibraryRoot)tools</LibraryToolsFolder>
  </PropertyGroup>
  <UsingTask TaskName="VerifyAuthenticodeSignatureTask" AssemblyFile="$(LibraryToolsFolder)\Microsoft.Azure.Build.Tasks.dll"  />
  <UsingTask TaskName="DebugTask" AssemblyFile="$(LibraryToolsFolder)\Microsoft.Azure.Build.Tasks.dll"  />
  <Target Name="VerifyAssemblyWithoutAuthCodeSigned">
    <DebugTask Timeoutmiliseconds="5000"/>
    <VerifyAuthenticodeSignatureTask Assembly="..\Microsoft.Azure.Build.Tasks.dll" ContinueOnError="true">
      <Output TaskParameter="AuthTaskErrorsDetected" PropertyName="AuthTaskFailed" />
    </VerifyAuthenticodeSignatureTask>
    <Message Condition="'$(AuthTaskFailed)' == 'true'" Text="Test Passed !!!!!!!!!!"/>
    <Message Condition="'$(AuthTaskFailed)' == 'false'" Text="!!!!!!!!!! Test Failed !!!!!!!!!!"/>
  </Target>
  <Target Name="VerifyAssemblyWithAuthCodeSigned">
    <VerifyAuthenticodeSignatureTask Assembly="$(MSBuildToolsPath)\msbuild.exe">
      <Output TaskParameter="AuthTaskErrorsDetected" PropertyName="AuthTaskFailed" />
    </VerifyAuthenticodeSignatureTask>
    <Message Condition="'$(AuthTaskFailed)' == 'false'" Text="Test Passed !!!!!!!!!!"/>
    <Message Condition="'$(AuthTaskFailed)' == 'true'" Text="!!!!!!!!!! Test Failed !!!!!!!!!!"/>
  </Target>
  <Target Name="RunTest" DependsOnTargets="VerifyAssemblyWithoutAuthCodeSigned;VerifyAssemblyWithAuthCodeSigned">
    <Message Text="Test Suite completed"/>
  </Target>
</Project>